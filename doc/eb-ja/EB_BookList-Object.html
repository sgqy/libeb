<html lang="en">
<head>
<title>EB Library</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="EB Library">
<meta name="generator" content="makeinfo 4.5">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home">
</head>
<body>
<div class="node">
<p>
ノード:<a name="EB_BookList%20Object">EB_BookList Object</a>,
次:<a rel="next" accesskey="n" href="BookList-Data.html#BookList%20Data">BookList Data</a>,
前:<a rel="previous" accesskey="p" href="Book-List-on-Server.html#Book%20List%20on%20Server">Book List on Server</a>,
上:<a rel="up" accesskey="u" href="Book-List-on-Server.html#Book%20List%20on%20Server">Book List on Server</a>
<hr><br>
</div>

<h3 class="section"><code>EB_BookList</code> オブジェクト</h3>

   <p>EBNET サーバの提供する書籍および appendix データの一覧を取得するには、
まず <code>EB_BookList</code> 型のオブジェクトを用意する必要があります。

<pre class="example">     EB_BookList bl;
     </pre>

<p>オブジェクトの領域は、<code>malloc()</code> で確保しても構いません。

<pre class="example">     EB_BookList *bl_pointer;
     
     bl_pointer = (EB_BookList *) malloc(sizeof(EB_BookList));
     </pre>

   <p><code>EB_Book</code> オブジェクトと同様に、<code>EB_BookList</code> オブジェクトも
使う前に中身を初期化する必要があります。
これは、<code>eb_initialize_booklist()</code> という関数で行います。

<pre class="example">     eb_initialize_booklist(&amp;bl);
     eb_initialize_booklist(bl_pointer);
     </pre>

   <p>初期化が完了したら、特定のサーバとオブジェクトを結びつけます。
たとえば、<code>ebnet://localhost</code> で表されるサーバに対して、オブジェクト
を結びつけるには次のようにします。

<pre class="example">     if (eb_bind_booklist(&amp;bl, "ebnet://localhost") != EB_SUCCESS) {
         printf("eb_bind_booklist() failed\n");
         return;
     }
     </pre>

<p>これはちょうど、<code>EB_Book</code> オブジェクトに対して <code>eb_bind()</code>
を呼ぶのと同じです。

   <p>こうして、ようやく書籍一覧の情報を取り出すことができます。
これには <code>eb_booklist_book_count()</code>, <code>eb_booklist_book_name()</code>,
<code>eb_booklist_book_title()</code> という 3 つの関数を使用します。
これらの関数はそれぞれ、クライアントがアクセス可能な書籍の数、各書籍
および appendix データの名称 (アクセス識別子として指定する名前)、
各書籍と appendix データの題名を得ることができます。

<pre class="example">     char *name, *title;
     int count, i;
     
     count = eb_booklist_book_count(&amp;bl);
     for (i = 0; i &lt; count; i++) {
         if (eb_booklist_book_name(&amp;bl, i, &amp;name) != EB_SUCCESS) {
             printf("eb_booklist_book_name(%d) failed\n", i);
             return;
         }
         if (eb_booklist_book_title(&amp;bl, i, &amp;title) != EB_SUCCESS) {
             printf("eb_booklist_book_title(%d) failed\n", i);
             return;
         }
         printf("name = %s, title = %s\n", name, title);
     }
     </pre>

<p><code>EB_BookList</code> オブジェクトを使い終わったら、必ず後始末を行います。

<pre class="example">     eb_finalize_booklist(&amp;bl);
     eb_finalize_booklist(bl_pointer);
     </pre>

   <p>オブジェクトの領域を <code>malloc()</code> で確保した場合は、
<code>eb_finalize_booklist()</code> を呼んだ後ならば、オブジェクトの領域を
安全に解放することができます。

<pre class="example">     free(bl_pointer);
     </pre>

   </body></html>

