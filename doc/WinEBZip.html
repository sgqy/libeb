<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=shift_JIS">
<link rel="stylesheet" type="text/css" href="WinEBZip.css">
<link rev="made" href="mailto:m-kasahr@sra.co.jp">
<title>WinEBZip</title>
</head>

<body>
<h1>WinEBZip</h1>

<p>
Copyright (c) 2004  笠原 基之
</p>

<!-- ================================================================ -->
<h2><a name="toc">目次</a></h2>

<ul>
<li><a href="#introduction">はじめに</a>
<li><a href="#preparation">準備</a>
<li><a href="#execute">WinEBZip の実行</a>
<li><a href="#open-book">CD-ROM 書籍を開く</a>
<li><a href="#zip-unzip-book">圧縮・伸長する</a>
<li><a href="#miscellaneous">細かな仕様について</a>
<li><a href="#trouble-shoot">うまくいかない場合</a>
<li><a href="#copyright">使用許諾</a>
</ul>

<!-- ================================================================ -->
<h2><a name="introduction">はじめに</a></h2>

<p>
日本には EPWING や電子ブック形式の CD-ROM 書籍が数多く存在し、
商用、フリーを問わず様々な閲覧ソフトが開発されてきました。
</p>

<p>
閲覧ソフトの一部には、「ebzip 形式」と呼ばれるデータ圧縮形式に対応した
ものがあります。
EPWING や電子ブックのデータを ebzip 形式で圧縮しておけば、普段のデータ
容量は少なくて済みます。
特に、フラッシュメモリや容量の少ないハードディスク上に書籍データを
置いている PDA などでは、書籍データの圧縮は非常に重宝します。
</p>

<p>
WinEBZip は、CD-ROM 書籍を ebzip 形式で圧縮したり、反対に伸長した書籍を
伸長したりする事のできるソフトウェアです。
Windows 2000, XP 等で動作します。
</p>

<p>
公式ホームページは、以下の場所にあります。
</p>

<blockquote>
<p>
WinEBZip の公式ホームページ:<br>
<a href="http://www.sra.co.jp/people/m-kasahr/winebzip/">http://www.sra.co.jp/people/m-kasahr/winebzip/</a>
</p>
</blockquote>

<!-- ================================================================ -->
<h2><a name="preparation">準備</a></h2>

<p>
<em>
WinEBZip を実行するには、あらかじめ
「.NET Framework ランタイムライブラリ日本語版」と「EB ライブラリ」
をインストールしておく
必要があります。
</em>

<p>
.NET Framework ランタイムライブラリ日本語版は、Windows Update で
インストールする事ができます。
</p>

<p>
EB ライブラリについては、公式ホームページが以下の場所にあります。
ここから、EB ライブラリの Windows 版バイナリを入手できますので、
あらかじめインストールして下さい。
</p>

<blockquote>
<p>
EB ライブラリの公式ホームページ:<br>
<a href="http://www.sra.co.jp/people/m-kasahr/eb/">http://www.sra.co.jp/people/m-kasahr/eb/</a>
</p>
</blockquote>

<p>
なお、EB ライブラリは、バージョン 4.1.2 かもしくはそれ以降のバージョンを
お使い下さい。
</p>

<!-- ================================================================ -->
<h2><a name="execute">WinEBZip の実行</a></h2>

<p>
はじめて WinEBZip を起動したときは、次のように EB ライブラリの
インストールしているフォルダの位置を聞いてきます。
</p>

<p class="center">
<img src="eb-browser.png" alt="EBライブラリの位置の指定画面">
</p>

<p>
EB ライブラリをインストールした際に、インストール場所を変更
しなかった場合は、<code>"C:\Program Files\EB Library"</code> のような
フォルダになるはずです。
</p>

<p>
正しく入力すると、WinEBZip のメイン画面が表示されます
(<a href="#open-book">次項</a> 参照)。
</p>

<p>
なお、二回目以降に WinEBZip を起動したときでも、EB ライブラリが
見つからないと、やはりインストール先を聞いてきます
(EB ライブラリをアンインストールした場合など)。
再度指定し直して下さい。
</p>

<!-- ================================================================ -->
<h2><a name="open-book">CD-ROM 書籍を開く</a></h2>

<p>
実行した直後、WinEBZip のメイン画面は次のようになっています。
まだ CD-ROM 書籍を開いていないので、ほとんど空白になっています。
</p>

<p class="center">
<img src="main-empty.png" alt="空のメイン画面">
</p>

<p>
圧縮や伸長を行うには、CD-ROM 書籍を開く必要があります。
また、既に圧縮された CD-ROM 書籍も、開く事によって現在の圧縮状況を
確認する事ができます。
CD-ROM 書籍を開くには、「書籍のパス:」と書かれた列の右端にある、
「参照...」ボタンを押して下さい。
(または、メニューバーの「ファイル」→「書籍を開く...」を選んでも、
同じ動作をします。)
すると、フォルダを選択する画面が表示されます。
</p>

<p class="center">
<img src="book-browser.png" alt="書籍の位置の指定画面">
</p>

<p>
ここで、CD-ROM 書籍のフォルダを指定します。
</p>

<p>
<em>
「CD-ROM 書籍」のデータはフォルダが複数階層に分かれていますが、
一番上のフォルダを指定します。
このフォルダには必ず <code>CATALOG</code> もしくは <code>CATALOGS</code>
という名前のファイルが存在します。
</em>
(書籍によっては、ファイル名は小文字かも知れません。)
このファイルが存在するフォルダを指定して下さい。
</p>

<p class="center">
<img src="explorer.png" alt="エクスプローラで見た書籍">
</p>

<p>
EPWING や電子ブックは CD-ROM で販売されていたため、ここでは便宜上
「CD-ROM 書籍」と呼んでいますが、もちろんデータの内容をハードディスク等
にコピーした場合も、WinEBZip で扱う事が可能です。
</p>

<p>
正しいフォルダ位置を指定すると、メイン画面に CD-ROM 書籍の各ファイル
について、現在の圧縮状況が表示されます。
</p>

<p class="center">
<img src="main-book.png"  alt="辞書を開いたメイン画面">
</p>

<p>
EPWING や電子ブックの一部には、最初から圧縮された状態で販売されている
ものもあります。
これらの書籍を WinEBZip で開くと、圧縮方式の欄に「EPWING 形式」
「S-EBXA 形式」と表示されます。
ebzip 形式で圧縮したものは、「ebzip レベル 0」のように表示されます。
</p>

<!-- ================================================================ -->
<h2><a name="zip-unzip-book">圧縮・伸長する</a></h2>

<p>
圧縮・伸長を行うには、あらかじめ
<a href="#open-book">CD-ROM 書籍を開いておきます</a>。
</p>

<p>
ツールバー上に、圧縮と伸長のボタンがありますので、行いたい処理に
合わせてボタンを押します。
メニューバーの「ファイル」にも「圧縮」と「伸長」がありますので、
そちらから行っても同じです。
</p>

<p class="center">
<img src="toolbar.png" alt="ツールバー">
</p>

<p>
すると、次のような画面が表示されます。
これから行う圧縮や伸長についての様々な設定を、ここで行います。
</p>

<p class="center">
<img src="zip-config1.png" alt="圧縮・伸長の画面 (基本画面)">
</p>

<p>
 EPWING 形式、S-EBXA 形式で圧縮されている書籍に対して、圧縮を行う事も
可能です。
この場合、WinEBZip は自動的にいったん伸長してから ebzip 形式で圧縮し直し
ます。
</p>

<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  -->
<h3><a name="zip-config1">圧縮・伸長: 基本設定</a></h3>

<p class="center">
<img src="zip-config1.png" alt="圧縮・伸長の画面 (基本画面)">
</p>

<hr>
<h4>書き込み先</h4>

<p>
圧縮・伸長処理を施したファイルを書き込むフォルダ位置を指定します。
「参照...」ボタンを押すと、CD-ROM 書籍を開くときと同じように
フォルダの選択画面が表示さますので、書き込み先を指定して下さい。
開いた CD-ROM 書籍と同じ場所を指定することもできます。
</p>

<p>
ヒント: 
CD-ROM には書き込めませんので、
<em>
開いている CD-ROM 書籍と同じ場所を「書き込み先」に指定するのは、すでに
ハードディスクにコピーしている CD-ROM書籍を圧縮・伸長する場合だけです。
</em>
</p>

<p>
ヒント: 
<em>
開いている CD-ROM 書籍と同じ場所を「書き込み先」に指定する場合、
<a href="#zip-config4">オプション</a> の「元のファイルを削除する」は
必ず有効にしましょう。
</em>
でないと、圧縮・伸長の処理の後で、元のファイルと処理によって生成された
ファイルが同じ場所に混在してしまいます。
</p>

<hr>
<h4>圧縮レベル (圧縮時のみ)</h4>

<p>
高いレベルを選ぶほど、圧縮後のファイルが小さくなります。
けれどもその代償として、閲覧ソフトがファイルを伸長する際に、処理時間が
少し余計にかかってしまいます。
</p>

<p>
ヒント: どれを選べば良いかよく分からなければ、4 あたりを指定しましょう。
(ただし、非力なパソコンでは、もう少し下げたほうがいいかも知れません。)
</p>

<p>
なお、圧縮レベルが指定できるのは圧縮時だけです。
伸長時には指定できません。
</p>

<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  -->
<h3><a name="zip-config2">圧縮・伸長: 副本の選択</a></h3>

<p class="center">
<img src="zip-config2.png" alt="圧縮・伸長の画面 (副本の選択)">
</p>

<hr>
<h4>対象処理の副本</h4>

<p>
EPWING や電子ブックでは、一つの製品 (1 枚の CD-ROM) の中に複数個の
「書籍」を収めていることが少なくありません。
WinEBZip では、一つの製品に収録されている個々の書籍を「副本」と呼んで
います。
</p>

<p>
「対象処理の副本」欄では、圧縮・伸長処理の対象とする副本を取捨選択します。
<em>
選ばなかった副本に属するファイルは圧縮や伸長が一切行われず、副本そのもの
が書き込み先では欠落することになります。
</em>
その分、書き込み先のデータ容量は減ります。
取捨選択を行うと、処理対象となる書籍データの合計サイズが変化しますので、
目安にして下さい。
</p>

<p class="center">
<img src="zip-config-size.png" alt="圧縮・伸長の対象サイズ">
</p>

<p>
ただし、
<em>
開いている CD-ROM 書籍と同じ場所に書き込む場合、副本を非選択
にしてもデータ容量は減りません。
</em>
非選択にした副本のファイルは、削除されずにそのまま残るからです。
</p>

<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  -->
<h3><a name="zip-config3">圧縮・伸長: ファイルの選択</a></h3>


<p class="center">
<img src="zip-config3.png" alt="圧縮・伸長の画面 (ファイルの選択)">
</p>

<hr>
<h4>処理対象のファイル</h4>

<p>
一部の書籍では、画像データや音声データがファイルとして独立しています。
利用者が望むなら、これらのファイルを圧縮・伸長の対象から除外することで、
処理対象となるデータの合計サイズを減らすことができます。
</p>

<p>
なお、処理対象に選んでも、必ずしも圧縮が行われるわけではなく、
たんに書き込み先に元と同じデータがコピーされる場合もあります。
画像データや動画データは、すでにデータ自体に圧縮がかかっているため、
ebzip 形式で再度圧縮してもサイズの縮小が期待できないためです。
</p>

<p>
副本の選択と同様に、
<em>
選ばなかったファイルは圧縮や伸長が一切行われず、書き込み先では当該
ファイルが欠落することになります。
</em>
</p>

<p>
また、これも副本の選択と同様ですが、
<em>
開いている CD-ROM 書籍と同じ場所に書き込む場合、ファイルを非選択
にしてもデータ容量は減りません。
</em>
非選択にしたファイルは、削除されずにそのまま残るからです。
</p>

<p>
ヒント:
書籍によっては、外字がないと本文がまともに読めないもの少なくないので、
<em>
少なくとも、外字ファイルだけは選択しておくことをお薦めします。
</em>
</p>

<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  -->
<h3><a name="zip-config4">圧縮・伸長: オプション</a></h3>

<p class="center">
<img src="zip-config4.png" alt="圧縮・伸長の画面 (オプション)">
</p>

<hr>
<h4>ファイルの上書き</h4>

<p>
書き込み先のファイルが既に存在していた場合、どうするのかを指定します。
</p>

<hr>
<h4>「元のファイルを削除しない」オプション</h4>

<p>
このオプションを有効にしなければ、圧縮・伸長後に元のファイルは削除
されます。
CD-ROM 上のファイルは削除しようとしても失敗しますが、削除に失敗しても
圧縮・伸長処理は続行されるので、あまり気にする必要はありません。
</p>

<p>
<em>
開いた CD-ROM 書籍と同じ場所を「書き込み先」に指定している場合は、
必ず元のファイルを削除して下さい。
</em>
でないと、圧縮・伸長の処理の後で、元のファイルと処理によって生成された
ファイルが同じ場所に混在してしまいます。
</p>

<hr>
<h4>「ファイルに書き出さない」オプション</h4>

<p>
圧縮・伸長のテストを行うだけで、実際にファイルには書き出しません。
</p>

<p>
あまり利用する機会はないと思いますが、
圧縮時に利用すると、圧縮後に実際にどれくらいのデータ容量になるのかが
分かります。
また、圧縮済みの書籍に対して伸長する時に利用すると、圧縮データが壊れて
いないか確認できます。
</p>

<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  -->
<h3><a name="zip-progress">圧縮・伸長の進行状況</a></h3>

<p>
圧縮・伸長の設定が済んで、実行を開始すると、進行状況を示す画面が
表示されます。
</p>

<p class="center">
<img src="zip-progress.png"  alt="圧縮・伸長の進行画面">
</p>

<p>
処理が正常に完了し画面の「閉じる」ボタンを押すか、処理中に「中止」
のボタンを押すと、メイン画面に戻ります。
正常に完了したときは、メイン画面には書き込み先の書籍の圧縮状況が表示
されます。
</p>

<p>
中止の場合は、書き込み元の書籍の圧縮状況が表示されます。
ただし、「元のファイルを削除しない」オプションを無効にしていた場合、
書き込み元の書籍は整合性が失われ、エラーが表示される可能性があります。
</p>

<!-- ================================================================ -->
<h2><a name="miscellaneous">細かな仕様について</a></h2>

<ul>
<li>
EB ライブラリがサポートしていないファイル (<code>VTOC</code> や
電子ブックの <code>SOUND</code> など) は、無視されます。
メイン画面のファイル一覧にも表れませんし、圧縮・伸長の際にも処理は
行われません。

<li>
WinEBZip (EB ライブラリ) では CATALOG, CATALOGS ファイルを圧縮しません。
たんにコピーされるだけです。

<li>
EPWING 形式、S-EBXA 形式で圧縮することはできません。
これらの形式は、伸長しか行えません。

<li>
epwutil の squeeze コマンドとは連携できません。

</ul>

<!-- ================================================================ -->
<h2><a name="trouble-shoot">うまくいかない場合</a></h2>

<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  -->
<h3>起動できない</h3>

<p>
考えられる原因と対処方法:
</p>

<h4>古い Windows で実行しようとしている</h4>

<p>
Windows 95/98/Me および Windows NT 等では動かないと思います。
</p>

<h4>.NET Framework ランタイムライブラリがインストールされていない</h4>

<p>
Windowd Update でインストールしましょう。
</p>

<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  -->
<h3>メイン画面に書籍の圧縮状況が表示されない</h3>

<p>
考えられる原因と対処方法:
</p>

<h4>EB ライブラリのバージョンが古い</h4>

<p>
まず、ライブラリのバージョンを確認しましょう。
複数の EB ライブラリをインストールしている場合は、古いほうを指定して
いないか確認して下さい。
</p>

<h4>公式サイトで配布している EB ライブラリではない</h4>

<p>
仕様が細かくことなるかも知れません。
WinEBZip では、EB ライブラリの公式サイトで配布している物以外での
動作は検証していません。
</p>

<p>
また、EB ライブラリをソースコードから自力でビルドした場合、インストール
の際にファイルの配置が WinEBZip の期待している形と違うかも知れません。
公式サイトのバイナリと合わせるか、WinEBZip では公式サイトのバイナリを
使うようにして下さい。
</p>

<!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  -->
<h3>圧縮しても、後で確認すると「非圧縮」になっている</h3>

<p>
考えられる原因と対処方法:
</p>

<h4>書き込み先が元と同じで、元のファイルを削除しなかった</h4>

<p>
非圧縮と圧縮ファイルが同じフォルダに同居してしまっている場合、
非圧縮のファイルを優先的に認識するようになっています。
(閲覧ソフトにとっては、読み込む際に伸長処理をせずに済むからです。)
</p>

<p>
<a href="#zip-config4">「元のファイルを削除する」オプション</a> を有効に
して、圧縮をやり直しましょう。
</p>

<!-- ================================================================ -->
<h2><a name="copyright">使用許諾</a></h2>

<p>
WinEBZip はフリーソフトウェアです。
あなたは、Free Software Foundation が公表した GNU General Public License
(GNU 一般公有使用許諾) バージョン 2 あるいはそれ以降の各バージョンの中
からいずれかを選択し、そのバージョンが定める条項に従って本プログラムを
再頒布または変更することができます。
</p>

<p>
WinEBZip は有用とは思いますが、頒布にあたっては、市場性及び特定目的適合性
についての暗黙の保証を含めて、いかなる保証も行ないません。
詳細については <a href="../COPYING.txt">GNU General Public License</a>
をお読みください。
</p>

<!-- ================================================================ -->
<hr>
<p>
<a href="http://www.sra.co.jp/people/m-kasahr/eb/"><img src="eb_b.png" alt="EB Library"></a>
</p>

</body>
</html>
